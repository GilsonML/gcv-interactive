<!DOCTYPE html>
<html lang="pt-BR">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>GCV-INTERACTIVE - Gerador de CurrÃ­culos</title>
   <script src="https://cdn.tailwindcss.com"></script>
   <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
   <style>
       ::-webkit-scrollbar { width: 8px; height: 8px; }
       ::-webkit-scrollbar-track { background: #f1f1f1; }
       ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
       ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }

       .a4-paper { 
           width: 210mm; 
           min-height: 297mm; 
           max-height: 297mm;
           background: white; 
           box-shadow: 0 0 20px rgba(0,0,0,0.1); 
           margin: 0 auto; 
           position: relative; 
           overflow: hidden;
           box-sizing: border-box; 
           padding: 12mm !important;
       }

       @media print {
           body * { visibility: hidden; }
           #cv-content, #cv-content * { visibility: visible; }
           #cv-content { 
               position: absolute; 
               left: 0; 
               top: 0; 
               width: 100%;
               padding: 12mm;
               background: white;
               color: black;
               overflow: hidden;
           }
       }

       .pdf-simulation-mode {
           position: fixed !important;
           top: 0 !important;
           left: 0 !important;
           width: 100vw !important;
           height: 100vh !important;
           z-index: 9999 !important;
           background: #525659 !important;
           display: flex !important;
           flex-direction: column !important;
           align-items: center !important;
           justify-content: flex-start !important;
           overflow-y: auto !important;
           padding: 40px 20px !important;
       }

       .pdf-toolbar {
           position: fixed;
           top: 0;
           left: 0;
           right: 0;
           height: 60px;
           background: #323639;
           display: flex;
           align-items: center;
           justify-content: space-between;
           padding: 0 20px;
           z-index: 10000;
           color: white;
       }

       .dev-only { display: none; }
       .dev-mode .dev-only { display: block; }
       
       .download-counter-badge {
           position: fixed;
           bottom: 20px;
           left: 20px;
           background: rgba(0,0,0,0.95);
           color: #10b981;
           padding: 15px 25px;
           border-radius: 50px;
           font-size: 16px;
           font-weight: 600;
           z-index: 10001;
           backdrop-filter: blur(10px);
           border: 2px solid #10b981;
           box-shadow: 0 10px 30px rgba(0,0,0,0.7);
           display: none;
           align-items: center;
           gap: 15px;
       }
       
       .dev-mode .download-counter-badge {
           display: flex !important;
       }
       
       .dev-stats-panel {
           position: fixed;
           top: 80px;
           left: 20px;
           background: rgba(17, 24, 39, 0.98);
           color: white;
           padding: 25px;
           border-radius: 20px;
           border: 2px solid #10b981;
           z-index: 10000;
           width: 320px;
           transform: translateX(-120%);
           transition: transform 0.4s;
           border-left: 5px solid #10b981;
           box-shadow: 0 20px 40px rgba(0,0,0,0.8);
       }
       
       .dev-mode .dev-stats-panel { 
           transform: translateX(0); 
       }
       
       .dev-stats-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 20px;
           padding-bottom: 15px;
           border-bottom: 2px solid #374151;
       }
       
       .dev-stats-header h3 {
           font-size: 18px;
           font-weight: 700;
           color: #10b981;
           text-transform: uppercase;
       }
       
       .dev-stats-header span {
           background: #10b981;
           color: #111827;
           padding: 5px 12px;
           border-radius: 30px;
           font-size: 12px;
           font-weight: 700;
       }
       
       .dev-stat-item {
           display: flex;
           justify-content: space-between;
           margin-bottom: 15px;
           font-size: 15px;
           padding: 5px 0;
       }
       
       .dev-stat-label { 
           color: #9ca3af;
           display: flex;
           align-items: center;
           gap: 8px;
       }
       
       .dev-stat-value { 
           color: #10b981; 
           font-weight: 700;
           font-size: 18px;
           background: rgba(16, 185, 129, 0.15);
           padding: 5px 15px;
           border-radius: 30px;
           border: 1px solid rgba(16, 185, 129, 0.5);
       }
       
       .dev-reset-btn {
           width: 100%;
           background: #374151;
           color: #ef4444;
           padding: 12px;
           border-radius: 12px;
           font-size: 14px;
           margin-top: 20px;
           cursor: pointer;
           border: 2px solid #ef4444;
           font-weight: 600;
           transition: all 0.3s;
           display: flex;
           align-items: center;
           justify-content: center;
           gap: 10px;
       }
       
       .dev-reset-btn:hover {
           background: #ef4444;
           color: white;
       }
       
       .dev-indicator {
           position: fixed;
           top: 80px;
           right: 20px;
           background: #10b981;
           color: #111827;
           padding: 12px 20px;
           border-radius: 50px;
           font-size: 14px;
           font-weight: 700;
           z-index: 10000;
           display: none;
           align-items: center;
           gap: 10px;
           box-shadow: 0 10px 25px rgba(16, 185, 129, 0.5);
           border: 2px solid white;
       }
       
       .dev-mode .dev-indicator {
           display: flex;
       }
   </style>
</head>
<body class="bg-gray-100 text-gray-800 h-screen flex flex-col overflow-hidden font-sans">

   <div class="dev-indicator no-print">
       <i class="fas fa-code"></i> MODO DESENVOLVEDOR ATIVO
       <span class="bg-black text-white px-3 py-1 rounded text-xs">Ctrl+Shift+D</span>
   </div>
   
   <div class="download-counter-badge no-print" id="downloadCounterBadge">
       <i class="fas fa-download text-2xl"></i>
       <div class="flex flex-col">
           <span class="text-xs text-gray-400">Total de Downloads</span>
           <span class="text-3xl font-bold text-white" id="downloadCountDisplay">0</span>
       </div>
       <div class="h-10 w-px bg-gray-600 mx-2"></div>
       <div class="flex flex-col">
           <span class="text-xs text-gray-400">Hoje</span>
           <span class="text-2xl font-bold text-white" id="todayCountDisplay">0</span>
       </div>
   </div>
   
   <div class="dev-stats-panel no-print" id="devStatsPanel">
       <div class="dev-stats-header">
           <h3><i class="fas fa-chart-line mr-2"></i>DEV STATS</h3>
           <span>v3.0</span>
       </div>
       
       <div class="dev-stat-item">
           <span class="dev-stat-label"><i class="fas fa-database"></i> Total de Downloads:</span>
           <span class="dev-stat-value" id="statTotalDownloads">0</span>
       </div>
       <div class="dev-stat-item">
           <span class="dev-stat-label"><i class="fas fa-calendar-day"></i> Downloads Hoje:</span>
           <span class="dev-stat-value" id="statTodayDownloads">0</span>
       </div>
       <div class="dev-stat-item">
           <span class="dev-stat-label"><i class="fas fa-clock"></i> SessÃ£o Atual:</span>
           <span class="dev-stat-value" id="statSessionDownloads">0</span>
       </div>
       <div class="dev-stat-item">
           <span class="dev-stat-label"><i class="fas fa-history"></i> Ãšltimo Reset:</span>
           <span class="dev-stat-value text-xs" id="statLastReset">Hoje</span>
       </div>
       
       <div class="border-t border-gray-700 my-3 pt-3">
           <div class="dev-stat-item">
               <span class="dev-stat-label"><i class="fas fa-chart-bar"></i> MÃ©dia/Dia:</span>
               <span class="dev-stat-value" id="statAverage">0</span>
           </div>
       </div>
       
       <button class="dev-reset-btn" onclick="resetDownloadCounter()">
           <i class="fas fa-trash-alt"></i> Resetar Todos os Contadores
       </button>
       
       <p class="text-xs text-gray-600 text-center mt-3">
           <i class="fas fa-eye-slash"></i> Apenas vocÃª vÃª estas estatÃ­sticas
       </p>
   </div>

   <div id="pdf-simulation-overlay" class="hidden fixed inset-0 z-[9999] bg-[#525659] flex-col">
       <div class="pdf-toolbar">
           <div class="flex items-center gap-4">
               <div class="flex items-center gap-2 text-red-400">
                   <i class="fas fa-file-pdf text-xl"></i>
                   <span class="font-semibold text-sm" id="pdf-filename">Curriculo.pdf</span>
               </div>
           </div>
           <div class="flex items-center gap-3">
               <button onclick="downloadPDF()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-1.5 rounded text-sm font-medium flex items-center gap-2">
                   <i class="fas fa-download"></i> Baixar PDF
               </button>
               <button onclick="closePDFSimulation()" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-1.5 rounded text-sm font-medium">
                   <i class="fas fa-times"></i> Fechar
               </button>
           </div>
       </div>
       <div class="pdf-container" id="pdf-container"></div>
   </div>

   <header class="bg-white border-b border-gray-200 h-16 flex items-center justify-between px-6 shadow-sm no-print shrink-0">
       <div class="flex items-center gap-3">
           <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-xl">
               <i class="fas fa-file-signature"></i>
           </div>
           <h1 class="font-bold text-xl text-gray-900">GCV<span class="text-blue-600">-INTERACTIVE</span></h1>
       </div>
       <div class="flex bg-gray-100 rounded-lg p-1 border border-gray-200">
           <button onclick="setTheme('modern')" class="theme-btn px-3 py-1.5 text-xs font-medium rounded-md bg-white shadow-sm" data-theme="modern">Moderno</button>
           <button onclick="setTheme('classic')" class="theme-btn px-3 py-1.5 text-xs font-medium rounded-md text-gray-500" data-theme="classic">ClÃ¡ssico</button>
           <button onclick="setTheme('minimal')" class="theme-btn px-3 py-1.5 text-xs font-medium rounded-md text-gray-500" data-theme="minimal">Minimalista</button>
           <button onclick="setTheme('vibrant')" class="theme-btn px-3 py-1.5 text-xs font-medium rounded-md text-gray-500" data-theme="vibrant">Vibrante</button>
       </div>
   </header>

   <div class="flex flex-1 overflow-hidden">
       <aside class="w-[450px] bg-white border-r border-gray-200 flex flex-col overflow-hidden no-print">
           <div class="flex border-b border-gray-200">
               <button onclick="switchTab('content')" id="tab-content" class="flex-1 py-4 text-sm font-medium text-blue-600 border-b-2 border-blue-600">ConteÃºdo</button>
               <button onclick="switchTab('layout')" id="tab-layout" class="flex-1 py-4 text-sm font-medium text-gray-500">Layout</button>
           </div>
           <div class="flex-1 overflow-y-auto p-6 space-y-8" id="editor-scroll-area"></div>
       </aside>

       <main class="flex-1 bg-gray-100/50 relative overflow-hidden flex flex-col">
           <div class="absolute bottom-6 right-6 flex flex-col gap-2 no-print z-30">
               <button onclick="adjustZoom(0.1)" class="w-10 h-10 bg-white rounded-full shadow-lg hover:bg-gray-50"><i class="fas fa-plus"></i></button>
               <button onclick="adjustZoom(-0.1)" class="w-10 h-10 bg-white rounded-full shadow-lg hover:bg-gray-50"><i class="fas fa-minus"></i></button>
               <button onclick="resetZoom()" class="w-10 h-10 bg-white rounded-full shadow-lg text-xs hover:bg-gray-50">Ajustar</button>
           </div>
           <div class="flex-1 overflow-auto p-8 flex justify-center items-start" id="preview-scroll-area">
               <div id="cv-preview-container" class="transition-transform duration-200 origin-top" style="transform: scale(0.9);">
                   <div id="cv-content" class="a4-paper theme-modern text-gray-800">
                       <header class="flex gap-4 mb-4 border-b-2 pb-3 items-start" style="border-color: #1e293b;">
                           <div id="preview-photo" class="w-20 h-20 rounded-lg bg-gray-200 bg-cover bg-center flex-shrink-0 hidden"></div>
                           <div class="flex-1">
                               <h1 class="text-2xl font-bold text-gray-900 mb-1" id="preview-name">Odair Miguel JÃºlio</h1>
                               <p class="text-base mb-2" style="color: #1e293b;" id="preview-title">Coordenador Geral</p>
                               <div class="flex flex-wrap gap-x-3 gap-y-1 text-xs text-gray-600">
                                   <span><i class="fas fa-envelope mr-1"></i> <span id="preview-email">odair@email.com</span></span>
                                   <span><i class="fas fa-phone mr-1"></i> <span id="preview-phone">+244 923 433 343</span></span>
                                   <span><i class="fas fa-map-marker-alt mr-1"></i> <span id="preview-location">Luanda, Angola</span></span>
                               </div>
                           </div>
                       </header>

                       <div class="grid grid-cols-3 gap-4">
                           <div class="col-span-1 space-y-4 border-r border-gray-200 pr-3">
                               <section><h2 class="text-xs font-bold uppercase mb-2" style="color:#1e293b;">Habilidades</h2><div id="preview-skills" class="flex flex-wrap gap-1"></div></section>
                               <section><h2 class="text-xs font-bold uppercase mb-2" style="color:#1e293b;">Idiomas</h2><div id="preview-languages" class="space-y-1"></div></section>
                               <section><h2 class="text-xs font-bold uppercase mb-2" style="color:#1e293b;">EducaÃ§Ã£o</h2><div id="preview-education" class="space-y-2"></div></section>
                           </div>
                           <div class="col-span-2 pl-2">
                               <section class="mb-3"><h2 class="text-xs font-bold uppercase mb-1" style="color:#1e293b;">Perfil</h2><p class="text-xs leading-relaxed text-gray-600" id="preview-summary"></p></section>
                               <section class="mb-3"><h2 class="text-xs font-bold uppercase mb-2" style="color:#1e293b;">ExperiÃªncia</h2><div id="preview-experience" class="space-y-3"></div></section>
                               <section><h2 class="text-xs font-bold uppercase mb-2" style="color:#1e293b;">PrÃªmios</h2><div id="preview-awards" class="space-y-2"></div></section>
                           </div>
                       </div>
                   </div>
               </div>
           </div>
       </main>
   </div>

   <footer class="bg-white border-t border-gray-200 py-2 px-6 text-center text-xs text-gray-600 no-print">
       Â© 2026 GCV-INTERACTIVE - Gilson Fernandes. ðŸ‡¦ðŸ‡´ Feito para Juventude Angolana
   </footer>

   <script>
       (function() {
           const defaultData = {
               name: "Odair Miguel JÃºlio",
               title: "Coordenador Geral do CNJ-AO",
               email: "odair.julio@exemplo.com",
               phone: "+244 923433343",
               location: "Luanda, Angola",
               summary: "Profissional com forte capacidade de lideranÃ§a, articulaÃ§Ã£o polÃ­tica e gestÃ£o de pessoas.",
               skills: ["Prototipagem", "Design Systems", "Power BI", "GestÃ£o", "ComunicaÃ§Ã£o"],
               experience: [
                   { role: "Coordenador Geral", company: "CNJ", date: "2023-Presente", description: "LideranÃ§a de equipe." },
                   { role: "Coordenador", company: "VITAL", date: "2020-2023", description: "GestÃ£o de projetos." }
               ],
               education: [
                   { degree: "Licenciatura", school: "Universidade Agostinho Neto", date: "2014-2018" }
               ],
               awards: [
                   { title: "Jovem de ExcelÃªncia", organization: "CNJ", year: "2024" }
               ],
               languages: [
                   { name: "PortuguÃªs", level: "Nativo" },
                   { name: "InglÃªs", level: "Fluente" }
               ],
               theme: "modern",
               photo: null
           };

           let cvData = JSON.parse(JSON.stringify(defaultData));
           let currentZoom = 0.9;
           
           // ===== CONTADOR GLOBAL FUNCIONAL =====
           let downloadStats = {
               total: 0,
               today: 0,
               session: 0,
               lastReset: new Date().toDateString()
           };

           const COUNTER_ID = 'gcv-interactive-total';
           const TODAY_ID = 'gcv-interactive-today';
           let devMode = false;

           async function loadDownloadStats() {
               try {
                   const totalRes = await fetch(`https://api.quickcounter.io/get/${COUNTER_ID}`);
                   const totalData = await totalRes.json();
                   const todayRes = await fetch(`https://api.quickcounter.io/get/${TODAY_ID}`);
                   const todayData = await todayRes.json();
                   
                   downloadStats.total = totalData.value || 0;
                   downloadStats.today = todayData.value || 0;
                   updateDisplay();
               } catch (e) {
                   console.warn('Erro API, usando localStorage');
                   const saved = localStorage.getItem('gcv_global_stats');
                   if (saved) {
                       downloadStats = JSON.parse(saved);
                   }
                   updateDisplay();
               }
           }

           async function incrementCounter() {
               try {
                   const totalRes = await fetch(`https://api.quickcounter.io/hit/${COUNTER_ID}`);
                   const totalData = await totalRes.json();
                   const todayRes = await fetch(`https://api.quickcounter.io/hit/${TODAY_ID}`);
                   const todayData = await todayRes.json();
                   
                   downloadStats.total = totalData.value;
                   downloadStats.today = todayData.value;
                   downloadStats.session++;
                   
                   localStorage.setItem('gcv_global_stats', JSON.stringify(downloadStats));
                   updateDisplay();
               } catch (e) {
                   downloadStats.total++;
                   downloadStats.today++;
                   downloadStats.session++;
                   updateDisplay();
               }
           }

           window.resetDownloadCounter = async function() {
               if (confirm('Resetar contadores?')) {
                   try {
                       await fetch(`https://api.quickcounter.io/set/${COUNTER_ID}?value=0`);
                       await fetch(`https://api.quickcounter.io/set/${TODAY_ID}?value=0`);
                       downloadStats = { total:0, today:0, session:0, lastReset: new Date().toDateString() };
                       updateDisplay();
                       alert('Contadores resetados!');
                   } catch(e) {
                       alert('Erro ao resetar');
                   }
               }
           };

           function updateDisplay() {
               document.getElementById('downloadCountDisplay').textContent = downloadStats.total;
               document.getElementById('todayCountDisplay').textContent = downloadStats.today;
               document.getElementById('statTotalDownloads').textContent = downloadStats.total;
               document.getElementById('statTodayDownloads').textContent = downloadStats.today;
               document.getElementById('statSessionDownloads').textContent = downloadStats.session;
               document.getElementById('statLastReset').textContent = downloadStats.lastReset;
               const media = downloadStats.total || 0;
               document.getElementById('statAverage').textContent = media;
           }

           function toggleDevMode() {
               devMode = !devMode;
               document.body.classList.toggle('dev-mode', devMode);
               if (devMode) loadDownloadStats();
           }

           document.addEventListener('keydown', (e) => {
               if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'D') {
                   e.preventDefault();
                   toggleDevMode();
               }
           });

           window.downloadPDF = async function() {
               try {
                   await incrementCounter();
                   
                   const btn = event?.target?.closest('button');
                   const originalText = btn?.innerHTML || 'Baixar PDF';
                   if (btn) {
                       btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Gerando...';
                       btn.disabled = true;
                   }
                   
                   const nomeArquivo = (cvData.name || 'Curriculo').replace(/\s+/g, '_') + '.pdf';
                   const element = document.getElementById('cv-content');
                   
                   const canvas = await html2canvas(element, {
                       scale: 2,
                       backgroundColor: '#ffffff'
                   });
                   
                   const { jsPDF } = window.jspdf;
                   const imgData = canvas.toDataURL('image/jpeg', 0.95);
                   const pdf = new jsPDF();
                   pdf.addImage(imgData, 'JPEG', 10, 10, 190, 0);
                   pdf.save(nomeArquivo);
                   
                   if (btn) {
                       btn.innerHTML = originalText;
                       btn.disabled = false;
                   }
               } catch (error) {
                   alert('Erro: ' + error.message);
               }
           };

           // FunÃ§Ãµes auxiliares (mantidas iguais)
           window.handlePhotoUpload = function(input) {
               if (input.files && input.files[0]) {
                   const reader = new FileReader();
                   reader.onload = function(e) {
                       cvData.photo = e.target.result;
                       updatePhotoPreview();
                       localStorage.setItem('gcv_photo', cvData.photo);
                   };
                   reader.readAsDataURL(input.files[0]);
               }
           };

           window.removePhoto = function() {
               cvData.photo = null;
               updatePhotoPreview();
               localStorage.removeItem('gcv_photo');
           };

           function updatePhotoPreview() {
               const previewPhoto = document.getElementById('preview-photo');
               if (cvData.photo) {
                   previewPhoto.style.backgroundImage = `url('${cvData.photo}')`;
                   previewPhoto.classList.remove('hidden');
               } else {
                   previewPhoto.classList.add('hidden');
               }
           }

           function loadSavedPhoto() {
               const saved = localStorage.getItem('gcv_photo');
               if (saved) {
                   cvData.photo = saved;
                   updatePhotoPreview();
               }
           }

           function renderPreview() {
               document.getElementById('preview-name').textContent = cvData.name;
               document.getElementById('preview-title').textContent = cvData.title;
               document.getElementById('preview-email').textContent = cvData.email;
               document.getElementById('preview-phone').textContent = cvData.phone;
               document.getElementById('preview-location').textContent = cvData.location;
               document.getElementById('preview-summary').textContent = cvData.summary;
               
               const skillsContainer = document.getElementById('preview-skills');
               skillsContainer.innerHTML = '';
               cvData.skills.forEach(skill => {
                   skillsContainer.innerHTML += `<span class="px-2 py-0.5 rounded text-xs bg-gray-100 border">${skill}</span>`;
               });
               
               const expContainer = document.getElementById('preview-experience');
               expContainer.innerHTML = '';
               cvData.experience.forEach(job => {
                   expContainer.innerHTML += `
                       <div class="mb-2">
                           <div class="flex justify-between"><span class="font-bold text-xs">${job.role}</span><span class="text-xs">${job.date}</span></div>
                           <div class="text-xs" style="color:#1e293b;">${job.company}</div>
                           <p class="text-xs">${job.description}</p>
                       </div>
                   `;
               });
               
               const eduContainer = document.getElementById('preview-education');
               eduContainer.innerHTML = '';
               cvData.education.forEach(edu => {
                   eduContainer.innerHTML += `<div class="mb-1"><div class="font-bold text-xs">${edu.degree}</div><div class="text-xs">${edu.school} - ${edu.date}</div></div>`;
               });
               
               const awardsContainer = document.getElementById('preview-awards');
               awardsContainer.innerHTML = '';
               cvData.awards.forEach(award => {
                   awardsContainer.innerHTML += `<div class="mb-1"><div class="font-bold text-xs">${award.title}</div><div class="text-xs">${award.organization} - ${award.year}</div></div>`;
               });
               
               const langContainer = document.getElementById('preview-languages');
               langContainer.innerHTML = '';
               cvData.languages.forEach(lang => {
                   langContainer.innerHTML += `<div class="flex justify-between text-xs"><span>${lang.name}</span><span class="bg-gray-100 px-2 rounded">${lang.level}</span></div>`;
               });
           }

           window.setTheme = function(theme) {
               cvData.theme = theme;
               document.getElementById('cv-content').className = 
                   document.getElementById('cv-content').className.replace(/theme-\w+/, `theme-${theme}`);
               document.querySelectorAll('.theme-btn').forEach(btn => {
                   if (btn.dataset.theme === theme) {
                       btn.classList.add('bg-white', 'shadow-sm');
                       btn.classList.remove('text-gray-500');
                   } else {
                       btn.classList.remove('bg-white', 'shadow-sm');
                       btn.classList.add('text-gray-500');
                   }
               });
           };

           window.simulatePDF = function() {
               document.getElementById('pdf-simulation-overlay').classList.remove('hidden');
               document.getElementById('pdf-simulation-overlay').classList.add('flex');
               document.body.style.overflow = 'hidden';
               const clone = document.getElementById('cv-content').cloneNode(true);
               clone.style.width = '210mm';
               clone.style.padding = '12mm';
               document.getElementById('pdf-container').innerHTML = '';
               document.getElementById('pdf-container').appendChild(clone);
           };

           window.closePDFSimulation = function() {
               document.getElementById('pdf-simulation-overlay').classList.add('hidden');
               document.body.style.overflow = '';
           };

           window.adjustZoom = function(delta) {
               currentZoom = Math.min(1.5, Math.max(0.5, currentZoom + delta));
               document.getElementById('cv-preview-container').style.transform = `scale(${currentZoom})`;
           };

           window.resetZoom = function() {
               currentZoom = 0.9;
               document.getElementById('cv-preview-container').style.transform = `scale(${currentZoom})`;
           };

           window.switchTab = function(tab) {
               const editorArea = document.getElementById('editor-scroll-area');
               if (tab === 'content') {
                   document.getElementById('tab-content').className = 'flex-1 py-4 text-sm font-medium text-blue-600 border-b-2 border-blue-600';
                   document.getElementById('tab-layout').className = 'flex-1 py-4 text-sm font-medium text-gray-500';
                   editorArea.innerHTML = getContentHTML();
                   setupSkillInput();
               }
           };

           function getContentHTML() {
               return `
                   <div class="space-y-4">
                       <h3 class="text-sm font-bold uppercase">InformaÃ§Ãµes Pessoais</h3>
                       <div class="flex gap-4 mb-4">
                           <div class="w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center text-2xl font-bold text-white bg-gradient-to-br from-blue-500 to-purple-600">${cvData.name.charAt(0)}</div>
                           <div class="flex-1">
                               <label class="block text-xs mb-1">Foto</label>
                               <label class="bg-blue-600 text-white text-xs px-3 py-2 rounded-lg cursor-pointer">
                                   <i class="fas fa-camera mr-1"></i> Adicionar Foto
                                   <input type="file" accept="image/*" class="hidden" onchange="handlePhotoUpload(this)">
                               </label>
                           </div>
                       </div>
                       <input type="text" data-field="name" class="w-full bg-gray-50 border rounded-lg px-3 py-2 text-sm" value="${cvData.name}">
                       <input type="text" data-field="title" class="w-full bg-gray-50 border rounded-lg px-3 py-2 text-sm" value="${cvData.title}">
                       <textarea data-field="summary" rows="2" class="w-full bg-gray-50 border rounded-lg px-3 py-2 text-sm">${cvData.summary}</textarea>
                       <input type="email" data-field="email" class="w-full bg-gray-50 border rounded-lg px-3 py-2 text-sm" value="${cvData.email}">
                       <input type="text" data-field="phone" class="w-full bg-gray-50 border rounded-lg px-3 py-2 text-sm" value="${cvData.phone}">
                       <input type="text" data-field="location" class="w-full bg-gray-50 border rounded-lg px-3 py-2 text-sm" value="${cvData.location}">
                       
                       <hr>
                       <div class="flex justify-between">
                           <h3 class="text-sm font-bold uppercase">Habilidades</h3>
                       </div>
                       <input type="text" id="skill-input" class="w-full bg-gray-50 border rounded-lg px-3 py-2 text-sm" placeholder="Digite e pressione Enter">
                       <div id="skills-editor-list" class="flex flex-wrap gap-2"></div>
                       
                       <div class="pt-4">
                           <button onclick="simulatePDF()" class="w-full bg-red-600 text-white py-3 rounded-xl font-bold">
                               <i class="fas fa-file-pdf mr-2"></i> VISUALIZAR PDF
                           </button>
                       </div>
                   </div>
               `;
           }

           function setupSkillInput() {
               const input = document.getElementById('skill-input');
               if (input) {
                   input.addEventListener('keydown', (e) => {
                       if (e.key === 'Enter') {
                           e.preventDefault();
                           const val = e.target.value.trim();
                           if (val) {
                               cvData.skills.push(val);
                               e.target.value = '';
                               renderSkillsList();
                               renderPreview();
                           }
                       }
                   });
               }
           }

           function renderSkillsList() {
               const container = document.getElementById('skills-editor-list');
               if (!container) return;
               container.innerHTML = '';
               cvData.skills.forEach((skill, index) => {
                   const span = document.createElement('span');
                   span.className = 'bg-white border px-2 py-1 rounded text-xs flex items-center gap-2';
                   span.innerHTML = `${skill} <button onclick="deleteSkill(${index})" class="text-red-500"><i class="fas fa-times"></i></button>`;
                   container.appendChild(span);
               });
           }

           window.deleteSkill = function(index) {
               cvData.skills.splice(index, 1);
               renderSkillsList();
               renderPreview();
           };

           document.querySelectorAll('[data-field]').forEach(input => {
               input.addEventListener('input', (e) => {
                   cvData[e.target.dataset.field] = e.target.value;
                   renderPreview();
               });
           });

           loadDownloadStats();
           loadSavedPhoto();
           renderPreview();
           renderSkillsList();
           document.getElementById('editor-scroll-area').innerHTML = getContentHTML();
           setupSkillInput();
       })();
   </script>
</body>
</html>
